<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lost & Found Pets - PawConnect</title>
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Lost & Found Specific Styles */
        .lost-found-hero {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 3rem 2rem;
            text-align: center;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .emergency-banner {
            background: #ff6b6b;
            color: white;
            padding: 1rem;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 2rem;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .report-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border-color);
        }

        .report-tab {
            padding: 1rem 2rem;
            background: transparent;
            border: none;
            cursor: pointer;
            font-weight: 500;
            color: var(--text-secondary);
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .report-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .pet-status-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .status-lost {
            background: #e74c3c;
        }

        .status-found {
            background: #27ae60;
        }

        .status-reunited {
            background: #3498db;
        }

        .search-radius {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 1rem 0;
        }

        .map-container {
            height: 300px;
            background: #f8f9fa;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            margin: 2rem 0;
        }

        .alert-setup {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            border: 2px dashed var(--primary-color);
        }

        .pet-details-extended {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .detail-item {
            background: var(--hover-bg);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .detail-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .detail-value {
            font-weight: 600;
            color: var(--text-primary);
        }

        .contact-owner {
            background: var(--primary-color);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 1rem;
        }

        .contact-owner:hover {
            background: var(--primary-dark);
        }

        .share-buttons {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .share-btn {
            padding: 0.5rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            color: white;
            transition: all 0.3s ease;
        }

        .share-facebook { background: #3b5998; }
        .share-twitter { background: #1da1f2; }
        .share-whatsapp { background: #25d366; }

        .report-form {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .photo-upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 1rem;
        }

        .photo-upload-area:hover {
            border-color: var(--primary-color);
            background: var(--hover-bg);
        }

        .success-stories {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
        }

        .story-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .story-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Navigation will be dynamically updated by session manager -->
    <nav id="main-navigation">
        <!-- Navigation will be dynamically updated by session manager -->
    </nav>

    <div class="container">
        <!-- Emergency Banner -->
        <div class="emergency-banner">
            ðŸš¨ EMERGENCY: Lost your pet? Report immediately for faster recovery! Call 24/7 Hotline: +880-1XXX-XXXXXX
        </div>

        <!-- Hero Section -->
        <div class="lost-found-hero">
            <h1>Lost & Found Pets</h1>
            <p>Help reunite pets with their families. Every share can make a difference!</p>
            <div class="hero-stats">
                <div class="stat-item">
                    <span class="number">247</span>
                    <span class="label">Pets Reunited</span>
                </div>
                <div class="stat-item">
                    <span class="number">89%</span>
                    <span class="label">Success Rate</span>
                </div>
                <div class="stat-item">
                    <span class="number">24/7</span>
                    <span class="label">Emergency Support</span>
                </div>
            </div>
        </div>

        <!-- Alert Setup -->
        <div class="alert-setup">
            <h3><i class="fas fa-bell"></i> Set Up Alerts</h3>
            <p>Get notified when pets matching your search criteria are reported in your area</p>
            <form id="alert-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>Pet Type</label>
                        <select name="alert_pet_type">
                            <option value="">Any Pet</option>
                            <option value="dog">Dog</option>
                            <option value="cat">Cat</option>
                            <option value="bird">Bird</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Location Radius</label>
                        <select name="alert_radius">
                            <option value="5">5 km</option>
                            <option value="10">10 km</option>
                            <option value="20">20 km</option>
                            <option value="50">50 km</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-bell"></i> Enable Alerts
                        </button>
                    </div>
                </div>
            </form>
        </div>

        <!-- Report Tabs -->
        <div class="report-tabs">
            <button class="report-tab active" onclick="showTab('lost-pets')">
                <i class="fas fa-search"></i> Lost Pets
            </button>
            <button class="report-tab" onclick="showTab('found-pets')">
                <i class="fas fa-heart"></i> Found Pets
            </button>
            <button class="report-tab" onclick="showTab('report-lost')">
                <i class="fas fa-plus"></i> Report Lost Pet
            </button>
            <button class="report-tab" onclick="showTab('report-found')">
                <i class="fas fa-paw"></i> Report Found Pet
            </button>
            <button class="report-tab" onclick="showTab('success-stories')">
                <i class="fas fa-trophy"></i> Success Stories
            </button>
        </div>

        <!-- Search and Filters -->
        <div class="search-filter">
            <div class="search-bar">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="search-input" placeholder="Search by pet name, breed, or description...">
                <button class="search-btn" onclick="searchPets()">
                    <i class="fas fa-search"></i> Search
                </button>
            </div>
            <div class="filters">
                <select id="petTypeSelect" onchange="filterPets()">
                    <option value="">All Pet Types</option>
                    <option value="dog">Dogs</option>
                    <option value="cat">Cats</option>
                    <option value="bird">Birds</option>
                    <option value="other">Other</option>
                </select>
                <select id="locationSelect" onchange="filterPets()">
                    <option value="">All Locations</option>
                    <option value="dhaka">Dhaka</option>
                    <option value="chittagong">Chittagong</option>
                    <option value="sylhet">Sylhet</option>
                    <option value="khulna">Khulna</option>
                </select>
                <select id="statusSelect" onchange="filterPets()">
                    <option value="">All Status</option>
                    <option value="lost">Lost</option>
                    <option value="found">Found</option>
                    <option value="reunited">Reunited</option>
                </select>
                <select id="dateRange" onchange="filterPets()">
                    <option value="">Any Time</option>
                    <option value="today">Today</option>
                    <option value="week">This Week</option>
                    <option value="month">This Month</option>
                </select>
            </div>
            <div class="search-radius">
                <label>Search Radius:</label>
                <input type="range" id="radius" min="1" max="100" value="10" onchange="updateRadius()">
                <span id="radius-value">10 km</span>
            </div>
        </div>

        <!-- Tab Content -->
        <div id="lost-pets" class="tab-content active">
            <div class="section-header">
                <h2>Lost Pets - Help Them Find Home</h2>
                <p>Share these posts to help reunite pets with their families</p>
            </div>
            <div id="lost-pets-container" class="adoption-grid"></div>
        </div>

        <div id="found-pets" class="tab-content">
            <div class="section-header">
                <h2>Found Pets - Looking for Their Families</h2>
                <p>Do you recognize any of these pets?</p>
            </div>
            <div id="found-pets-container" class="adoption-grid"></div>
        </div>

        <div id="report-lost" class="tab-content">
            <div class="section-header">
                <h2>Report a Lost Pet</h2>
                <p>Provide as much detail as possible to help find your pet</p>
            </div>
            <div class="report-form">
                <form id="lost-pet-form">
                    <div class="photo-upload-area" onclick="document.getElementById('lost-pet-photos').click()">
                        <i class="fas fa-camera" style="font-size: 2rem; color: var(--primary-color); margin-bottom: 1rem;"></i>
                        <h3>Upload Pet Photos</h3>
                        <p>Add multiple clear photos of your pet</p>
                        <input type="file" id="lost-pet-photos" multiple accept="image/*" style="display: none;">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Pet Name *</label>
                            <input type="text" name="pet_name" required>
                        </div>
                        <div class="form-group">
                            <label>Pet Type *</label>
                            <select name="pet_type" required>
                                <option value="">Select Type</option>
                                <option value="dog">Dog</option>
                                <option value="cat">Cat</option>
                                <option value="bird">Bird</option>
                                <option value="rabbit">Rabbit</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Breed</label>
                            <input type="text" name="breed" placeholder="e.g., Golden Retriever">
                        </div>
                        <div class="form-group">
                            <label>Age</label>
                            <input type="text" name="age" placeholder="e.g., 2 years">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Color/Markings *</label>
                            <input type="text" name="color" required placeholder="Describe pet's appearance">
                        </div>
                        <div class="form-group">
                            <label>Size</label>
                            <select name="size">
                                <option value="">Select Size</option>
                                <option value="small">Small</option>
                                <option value="medium">Medium</option>
                                <option value="large">Large</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Last Seen Location *</label>
                            <input type="text" name="last_location" required placeholder="Street, area, city">
                        </div>
                        <div class="form-group">
                            <label>Date Lost *</label>
                            <input type="date" name="date_lost" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Description *</label>
                        <textarea name="description" rows="4" required placeholder="Describe your pet's behavior, special markings, any medical conditions..."></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Your Name *</label>
                            <input type="text" name="owner_name" required>
                        </div>
                        <div class="form-group">
                            <label>Contact Number *</label>
                            <input type="tel" name="contact_number" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Reward (Optional)</label>
                        <input type="text" name="reward" placeholder="Reward amount if any">
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-bullhorn"></i> Report Lost Pet
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="resetForm('lost-pet-form')">
                            <i class="fas fa-redo"></i> Reset
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div id="report-found" class="tab-content">
            <div class="section-header">
                <h2>Report a Found Pet</h2>
                <p>Help a lost pet find their way home</p>
            </div>
            <div class="report-form">
                <form id="found-pet-form">
                    <div class="photo-upload-area" onclick="document.getElementById('found-pet-photos').click()">
                        <i class="fas fa-camera" style="font-size: 2rem; color: var(--primary-color); margin-bottom: 1rem;"></i>
                        <h3>Upload Pet Photos</h3>
                        <p>Clear photos help owners identify their pets</p>
                        <input type="file" id="found-pet-photos" multiple accept="image/*" style="display: none;">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Pet Type *</label>
                            <select name="pet_type" required>
                                <option value="">Select Type</option>
                                <option value="dog">Dog</option>
                                <option value="cat">Cat</option>
                                <option value="bird">Bird</option>
                                <option value="rabbit">Rabbit</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Estimated Age</label>
                            <select name="age">
                                <option value="">Unknown</option>
                                <option value="puppy">Puppy/Kitten</option>
                                <option value="young">Young (1-3 years)</option>
                                <option value="adult">Adult (3-7 years)</option>
                                <option value="senior">Senior (7+ years)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Found Location *</label>
                            <input type="text" name="found_location" required placeholder="Where did you find this pet?">
                        </div>
                        <div class="form-group">
                            <label>Date Found *</label>
                            <input type="date" name="date_found" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Pet Description *</label>
                        <textarea name="description" rows="4" required placeholder="Describe the pet's appearance, size, color, behavior..."></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Your Name *</label>
                            <input type="text" name="finder_name" required>
                        </div>
                        <div class="form-group">
                            <label>Contact Number *</label>
                            <input type="tel" name="contact_number" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Pet's Current Status</label>
                        <select name="current_status">
                            <option value="with_finder">Pet is with me</option>
                            <option value="shelter">Pet is at a shelter</option>
                            <option value="vet">Pet is at a veterinary clinic</option>
                            <option value="other">Other (specify in notes)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Additional Notes</label>
                        <textarea name="notes" rows="3" placeholder="Any additional information..."></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-heart"></i> Report Found Pet
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="resetForm('found-pet-form')">
                            <i class="fas fa-redo"></i> Reset
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div id="success-stories" class="tab-content">
            <div class="success-stories">
                <h2><i class="fas fa-trophy"></i> Success Stories</h2>
                <p>Heartwarming reunions made possible by our community</p>
                <div class="story-grid">
                    <div class="story-card">
                        <h4>Max & Sarah</h4>
                        <p>Reunited after 5 days</p>
                        <small>Shared 247 times</small>
                    </div>
                    <div class="story-card">
                        <h4>Luna & Ahmed</h4>
                        <p>Found within 24 hours</p>
                        <small>Community helped</small>
                    </div>
                    <div class="story-card">
                        <h4>Charlie & Family</h4>
                        <p>15 days missing</p>
                        <small>Happy reunion</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Map Container -->
        <div class="map-container">
            <div style="text-align: center;">
                <i class="fas fa-map-marked-alt" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                <h3>Interactive Map</h3>
                <p>Visual representation of lost and found pets in your area</p>
                <button class="btn btn-primary">
                    <i class="fas fa-map"></i> View Full Map
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer id="main-footer">
        <!-- Footer will be dynamically updated by session manager -->
    </footer>

    <script src="js/session-manager.js"></script>
    <script>
        // Initialize session manager
        const sessionManager = new SessionManager();
        
        // Check session and update UI
        sessionManager.checkSession().then(() => {
            sessionManager.updateUI();
            loadLostFoundPets();
        });

        // Tab functionality
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.report-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Load pets data
        function loadLostFoundPets() {
            loadLostPets();
            loadFoundPets();
        }

        function loadLostPets() {
            const container = document.getElementById('lost-pets-container');
            // Simulate lost pets data
            const lostPets = [
                {
                    id: 1,
                    name: 'Max',
                    type: 'Dog',
                    breed: 'Golden Retriever',
                    status: 'lost',
                    lastSeen: 'Dhanmondi, Dhaka',
                    daysLost: 3,
                    reward: 'à§³5,000',
                    image: 'https://via.placeholder.com/300x250?text=Max'
                },
                {
                    id: 2,
                    name: 'Luna',
                    type: 'Cat',
                    breed: 'Persian',
                    status: 'lost',
                    lastSeen: 'Gulshan, Dhaka',
                    daysLost: 1,
                    reward: 'à§³3,000',
                    image: 'https://via.placeholder.com/300x250?text=Luna'
                }
            ];

            container.innerHTML = lostPets.map(pet => createPetCard(pet, 'lost')).join('');
        }

        function loadFoundPets() {
            const container = document.getElementById('found-pets-container');
            // Simulate found pets data
            const foundPets = [
                {
                    id: 3,
                    type: 'Dog',
                    breed: 'Mixed',
                    status: 'found',
                    foundLocation: 'Uttara, Dhaka',
                    daysFound: 2,
                    description: 'Friendly brown dog, seems well-cared for',
                    image: 'https://via.placeholder.com/300x250?text=Found+Dog'
                }
            ];

            container.innerHTML = foundPets.map(pet => createPetCard(pet, 'found')).join('');
        }

        function createPetCard(pet, type) {
            const statusClass = type === 'lost' ? 'status-lost' : 'status-found';
            const statusText = type === 'lost' ? 'LOST' : 'FOUND';
            
            return `
                <div class="pet-card">
                    <div class="pet-status-badge ${statusClass}">${statusText}</div>
                    <div class="pet-image">
                        <img src="${pet.image}" alt="${pet.name || 'Pet'}" onerror="this.src='https://via.placeholder.com/300x250?text=Pet+Photo'">
                    </div>
                    <div class="pet-info">
                        <h3>${pet.name || 'Unknown Name'}</h3>
                        <div class="pet-details-extended">
                            <div class="detail-item">
                                <div class="detail-label">Type</div>
                                <div class="detail-value">${pet.type}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Breed</div>
                                <div class="detail-value">${pet.breed}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">${type === 'lost' ? 'Last Seen' : 'Found At'}</div>
                                <div class="detail-value">${pet.lastSeen || pet.foundLocation}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Days ${type === 'lost' ? 'Missing' : 'Ago'}</div>
                                <div class="detail-value">${pet.daysLost || pet.daysFound}</div>
                            </div>
                        </div>
                        ${pet.reward ? `<div style="background: #f39c12; color: white; padding: 0.5rem; border-radius: 5px; margin: 1rem 0; text-align: center; font-weight: bold;">Reward: ${pet.reward}</div>` : ''}
                        ${pet.description ? `<p style="margin: 1rem 0; color: var(--text-secondary);">${pet.description}</p>` : ''}
                        <button class="contact-owner" onclick="contactOwner(${pet.id})">
                            <i class="fas fa-phone"></i> Contact ${type === 'lost' ? 'Owner' : 'Finder'}
                        </button>
                        <div class="share-buttons">
                            <button class="share-btn share-facebook" onclick="sharePet(${pet.id}, 'facebook')">
                                <i class="fab fa-facebook"></i>
                            </button>
                            <button class="share-btn share-twitter" onclick="sharePet(${pet.id}, 'twitter')">
                                <i class="fab fa-twitter"></i>
                            </button>
                            <button class="share-btn share-whatsapp" onclick="sharePet(${pet.id}, 'whatsapp')">
                                <i class="fab fa-whatsapp"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Form submissions
        document.getElementById('lost-pet-form').addEventListener('submit', function(e) {
            e.preventDefault();
            if (!sessionManager.isLoggedIn) {
                alert('Please log in to report a lost pet');
                window.location.href = 'login.html';
                return;
            }
            alert('Lost pet reported successfully! We will notify the community.');
            resetForm('lost-pet-form');
        });

        document.getElementById('found-pet-form').addEventListener('submit', function(e) {
            e.preventDefault();
            if (!sessionManager.isLoggedIn) {
                alert('Please log in to report a found pet');
                window.location.href = 'login.html';
                return;
            }
            alert('Found pet reported successfully! The owner will be notified.');
            resetForm('found-pet-form');
        });

        document.getElementById('alert-form').addEventListener('submit', function(e) {
            e.preventDefault();
            if (!sessionManager.isLoggedIn) {
                alert('Please log in to set up alerts');
                window.location.href = 'login.html';
                return;
            }
            alert('Alert set up successfully! You will be notified of matching pets.');
        });

        // Utility functions
        function resetForm(formId) {
            document.getElementById(formId).reset();
        }

        function contactOwner(petId) {
            if (!sessionManager.isLoggedIn) {
                alert('Please log in to contact pet owners');
                window.location.href = 'login.html';
                return;
            }
            alert('Contact details will be shared with the pet owner/finder.');
        }

        function sharePet(petId, platform) {
            const url = window.location.href;
            const text = 'Help find this lost pet!';
            
            switch(platform) {
                case 'facebook':
                    window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
                    break;
                case 'twitter':
                    window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, '_blank');
                    break;
                case 'whatsapp':
                    window.open(`https://wa.me/?text=${text} ${url}`, '_blank');
                    break;
            }
        }

        function updateRadius() {
            const radius = document.getElementById('radius').value;
            document.getElementById('radius-value').textContent = radius + ' km';
            filterPets();
        }

        function filterPets() {
            // Implement filtering logic
            console.log('Filtering pets...');
        }

        function searchPets() {
            // Implement search logic
            console.log('Searching pets...');
        }
    </script>
</body>
</html>
